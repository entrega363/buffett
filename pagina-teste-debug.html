<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Debug - Buffet Sobral</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .test-button:hover {
            background: #7b1fa2;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }
        .error {
            background: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        .info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #0d47a1;
        }
    </style>
</head>
<body>
    <h1>üî¨ Teste de Debug - Buffet Sobral</h1>
    
    <div class="test-section">
        <h2>Diagn√≥stico Autom√°tico</h2>
        <div id="autoDiagnosis">
            <p>Executando diagn√≥stico autom√°tico...</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Testes Manuais</h2>
        <button class="test-button" onclick="testDOMElements()">Verificar Elementos DOM</button>
        <button class="test-button" onclick="testFunctions()">Verificar Fun√ß√µes</button>
        <button class="test-button" onclick="testNavigation()">Testar Navega√ß√£o</button>
        <button class="test-button" onclick="testSupabaseConnection()">Testar Conex√£o Supabase</button>
        <button class="test-button" onclick="testButtonClick()">Testar Clique em Bot√£o</button>
        
        <div id="testResults"></div>
    </div>
    
    <div class="test-section">
        <h2>Console de Erros</h2>
        <div id="errorConsole" style="background: #000; color: #00ff00; padding: 15px; border-radius: 4px; font-family: monospace; height: 200px; overflow-y: auto;">
            > Console de diagn√≥stico iniciado...
        </div>
    </div>

    <script>
        // Configura√ß√£o do Supabase
        const SUPABASE_URL = 'https://vopekxfyorbuyrvzcshy.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvcGVreGZ5b3JidXlydnpjc2h5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0NTkyNjMsImV4cCI6MjA3MzAzNTI2M30.jIQqu4j_0QfPpn67YXHyy760X6Z4wwhuHMj-xK3emP4';
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Fun√ß√£o para logar no console visual
        function logToConsole(message, type = 'info') {
            const consoleElement = document.getElementById('errorConsole');
            const timestamp = new Date().toLocaleTimeString();
            const typeSymbol = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            consoleElement.innerHTML += `\n[${timestamp}] ${typeSymbol} ${message}`;
            consoleElement.scrollTop = consoleElement.scrollHeight;
            
            // Tamb√©m logar no console real
            if (type === 'error') {
                console.error(message);
            } else if (type === 'success') {
                console.log(message);
            } else {
                console.info(message);
            }
        }
        
        // Fun√ß√£o para mostrar resultado de teste
        function showTestResult(message, isSuccess = true) {
            const resultsElement = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${isSuccess ? 'success' : 'error'}`;
            resultDiv.innerHTML = `${isSuccess ? '‚úÖ' : '‚ùå'} ${message}`;
            resultsElement.appendChild(resultDiv);
        }
        
        // Testar elementos DOM
        function testDOMElements() {
            document.getElementById('testResults').innerHTML = '';
            logToConsole('Iniciando teste de elementos DOM...');
            
            const elementos = [
                'autoDiagnosis',
                'testResults',
                'errorConsole'
            ];
            
            let successCount = 0;
            
            elementos.forEach(id => {
                const elemento = document.getElementById(id);
                if (elemento) {
                    logToConsole(`Elemento #${id} encontrado`, 'success');
                    successCount++;
                } else {
                    logToConsole(`Elemento #${id} N√ÉO encontrado`, 'error');
                }
            });
            
            showTestResult(`Elementos DOM: ${successCount}/${elementos.length} encontrados`, successCount === elementos.length);
        }
        
        // Testar fun√ß√µes
        function testFunctions() {
            document.getElementById('testResults').innerHTML = '';
            logToConsole('Iniciando teste de fun√ß√µes...');
            
            // Fun√ß√µes que devem existir
            const funcoes = [
                'logToConsole',
                'showTestResult',
                'testDOMElements',
                'testFunctions',
                'testNavigation',
                'testSupabaseConnection',
                'testButtonClick'
            ];
            
            let successCount = 0;
            
            funcoes.forEach(nome => {
                if (typeof window[nome] === 'function') {
                    logToConsole(`Fun√ß√£o ${nome} definida`, 'success');
                    successCount++;
                } else {
                    logToConsole(`Fun√ß√£o ${nome} N√ÉO definida`, 'error');
                }
            });
            
            showTestResult(`Fun√ß√µes: ${successCount}/${funcoes.length} definidas`, successCount === funcoes.length);
        }
        
        // Testar navega√ß√£o
        function testNavigation() {
            document.getElementById('testResults').innerHTML = '';
            logToConsole('Iniciando teste de navega√ß√£o...');
            
            // Criar elementos de teste
            const testContainer = document.createElement('div');
            testContainer.innerHTML = `
                <div class="nav-tabs">
                    <button class="nav-tab" onclick="showTestTab('tab1')">Tab 1</button>
                    <button class="nav-tab" onclick="showTestTab('tab2')">Tab 2</button>
                </div>
                <div class="content">
                    <div id="tab1" class="section">Conte√∫do Tab 1</div>
                    <div id="tab2" class="section">Conte√∫do Tab 2</div>
                </div>
            `;
            document.body.appendChild(testContainer);
            
            // Fun√ß√£o de navega√ß√£o de teste
            window.showTestTab = function(tabName) {
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(tabName).classList.add('active');
            };
            
            try {
                // Testar navega√ß√£o
                showTestTab('tab1');
                const tab1 = document.getElementById('tab1');
                if (tab1.classList.contains('active')) {
                    logToConsole('Navega√ß√£o funcionando corretamente', 'success');
                    showTestResult('Navega√ß√£o: Funcionando corretamente', true);
                } else {
                    logToConsole('Problema na navega√ß√£o', 'error');
                    showTestResult('Navega√ß√£o: Problema detectado', false);
                }
            } catch (erro) {
                logToConsole(`Erro na navega√ß√£o: ${erro.message}`, 'error');
                showTestResult(`Navega√ß√£o: Erro - ${erro.message}`, false);
            }
            
            // Remover elementos de teste
            document.body.removeChild(testContainer);
        }
        
        // Testar conex√£o com Supabase
        async function testSupabaseConnection() {
            document.getElementById('testResults').innerHTML = '';
            logToConsole('Iniciando teste de conex√£o com Supabase...');
            
            try {
                if (typeof supabase !== 'undefined' && supabase && typeof supabase.from === 'function') {
                    logToConsole('Cliente Supabase encontrado', 'success');
                    
                    // Testar conex√£o com uma tabela
                    const { data, error } = await supabase
                        .from('services')
                        .select('id')
                        .limit(1);
                    
                    if (error) {
                        logToConsole(`Erro na conex√£o: ${error.message}`, 'error');
                        showTestResult(`Supabase: Erro - ${error.message}`, false);
                    } else {
                        logToConsole('Conex√£o com Supabase estabelecida com sucesso', 'success');
                        showTestResult('Supabase: Conex√£o estabelecida', true);
                    }
                } else {
                    logToConsole('Cliente Supabase n√£o configurado corretamente', 'error');
                    showTestResult('Supabase: Cliente n√£o encontrado', false);
                }
            } catch (erro) {
                logToConsole(`Erro ao testar conex√£o: ${erro.message}`, 'error');
                showTestResult(`Supabase: Erro - ${erro.message}`, false);
            }
        }
        
        // Testar clique em bot√£o
        function testButtonClick() {
            document.getElementById('testResults').innerHTML = '';
            logToConsole('Iniciando teste de clique em bot√£o...');
            
            // Criar bot√£o de teste
            const testButton = document.createElement('button');
            testButton.textContent = 'Bot√£o de Teste';
            testButton.onclick = function() {
                logToConsole('Clique no bot√£o registrado com sucesso', 'success');
                showTestResult('Clique em bot√£o: Funcionando', true);
            };
            document.body.appendChild(testButton);
            
            // Simular clique
            testButton.click();
            
            // Remover bot√£o de teste
            document.body.removeChild(testButton);
        }
        
        // Diagn√≥stico autom√°tico ao carregar a p√°gina
        window.addEventListener('DOMContentLoaded', function() {
            const diagnosisElement = document.getElementById('autoDiagnosis');
            
            // Verificar estado do DOM
            logToConsole('P√°gina carregada - Iniciando diagn√≥stico autom√°tico...');
            
            let diagnosisHTML = '<h3>Resultado do Diagn√≥stico:</h3>';
            
            // Testar elementos principais
            const mainElements = ['autoDiagnosis', 'testResults', 'errorConsole'];
            let elementsFound = 0;
            
            mainElements.forEach(id => {
                if (document.getElementById(id)) {
                    elementsFound++;
                }
            });
            
            diagnosisHTML += `<p><strong>Elementos DOM:</strong> ${elementsFound}/${mainElements.length} encontrados</p>`;
            
            // Testar Supabase
            if (typeof supabase !== 'undefined') {
                diagnosisHTML += '<p><strong>Supabase:</strong> Cliente carregado</p>';
            } else {
                diagnosisHTML += '<p><strong>Supabase:</strong> <span style="color: red;">Cliente N√ÉO carregado</span></p>';
            }
            
            // Testar fun√ß√µes principais
            const mainFunctions = ['logToConsole', 'showTestResult'];
            let functionsFound = 0;
            
            mainFunctions.forEach(func => {
                if (typeof window[func] === 'function') {
                    functionsFound++;
                }
            });
            
            diagnosisHTML += `<p><strong>Fun√ß√µes principais:</strong> ${functionsFound}/${mainFunctions.length} definidas</p>`;
            
            diagnosisElement.innerHTML = diagnosisHTML;
            
            logToConsole('Diagn√≥stico autom√°tico conclu√≠do');
        });
        
        logToConsole('P√°gina de teste carregada com sucesso', 'success');
    </script>
</body>
</html>